<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
 <!--<![endif]-->
 <head>
  <meta content="noindex" name="robots"/>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   torch.compiler — PyTorch 2.7 documentation
  </title>
  <link href="https://pytorch.org/docs/stable/_modules/torch/compiler.html" rel="canonical"/>
  <link href="../../_static/css/theme.css" rel="stylesheet" type="text/css"/>
  <!-- <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" /> -->
  <link href="../../_static/pygments.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/css/theme.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/copybutton.css" rel="stylesheet" type="text/css"/>
  <link href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" rel="stylesheet" type="text/css"/>
  <link href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/katex-math.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/sphinx-dropdown.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/panels-bootstrap.min.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/css/jit.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/css/custom.css" rel="stylesheet" type="text/css"/>
  <link href="../../genindex.html" rel="index" title="Index"/>
  <link href="../../search.html" rel="search" title="Search"/>
  <!-- Google Tag Manager -->
  <script>
   (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T8XT4PS');
  </script>
  <!-- End Google Tag Manager -->
  <script src="../../_static/js/modernizr.min.js">
  </script>
  <!-- Preload the theme fonts -->
  <link as="font" crossorigin="anonymous" href="../../_static/fonts/FreightSans/freight-sans-book.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="anonymous" href="../../_static/fonts/FreightSans/freight-sans-medium.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="anonymous" href="../../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="anonymous" href="../../_static/fonts/FreightSans/freight-sans-bold.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="anonymous" href="../../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="anonymous" href="../../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" rel="preload" type="font/woff2"/>
  <!-- Preload the katex fonts -->
  <link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" rel="preload" type="font/woff2"/>
  <link crossorigin="anonymous" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" rel="stylesheet"/>
 </head>
 <div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
   <div class="header-container">
    <a aria-label="PyTorch" class="header-logo" href="https://pytorch.org/">
    </a>
    <div class="main-menu">
     <ul>
      <li class="main-menu-item">
       <div class="resources-dropdown" data-toggle="resources-dropdown" id="resourcesDropdownButton">
        <a class="with-down-arrow">
         Learn
        </a>
        <div class="resources-dropdown-menu">
         <a class="nav-dropdown-item" href="https://pytorch.org/get-started">
          <span class="dropdown-title">
           Get Started
          </span>
          <p>
           Run PyTorch locally or get started quickly with one of the supported cloud platforms
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/tutorials">
          <span class="dropdown-title">
           Tutorials
          </span>
          <p>
           Whats new in PyTorch tutorials
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/basics/intro.html">
          <span class="dropdown-title">
           Learn the Basics
          </span>
          <p>
           Familiarize yourself with PyTorch concepts and modules
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/recipes/recipes_index.html">
          <span class="dropdown-title">
           PyTorch Recipes
          </span>
          <p>
           Bite-size, ready-to-deploy PyTorch code examples
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/introyt.html">
          <span class="dropdown-title">
           Intro to PyTorch - YouTube Series
          </span>
          <p>
           Master PyTorch basics with our engaging YouTube tutorial series
          </p>
         </a>
        </div>
       </div>
      </li>
      <li>
       <div class="resources-dropdown" data-toggle="resources-dropdown" id="resourcesDropdownButton">
        <a class="with-down-arrow">
         Ecosystem
        </a>
        <div class="resources-dropdown-menu">
         <a class="nav-dropdown-item" href="https://pytorch.org/ecosystem">
          <span class="dropdown-title">
           Tools
          </span>
          <p>
           Learn about the tools and frameworks in the PyTorch Ecosystem
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/#community-module">
          <span class="dropdown-title">
           Community
          </span>
          <p>
           Join the PyTorch developer community to contribute, learn, and get your questions answered
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://discuss.pytorch.org/" target="_blank">
          <span class="dropdown-title">
           Forums
          </span>
          <p>
           A place to discuss PyTorch code, issues, install, research
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/resources">
          <span class="dropdown-title">
           Developer Resources
          </span>
          <p>
           Find resources and get questions answered
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/ecosystem/contributor-awards-2024">
          <span class="dropdown-title">
           Contributor Awards - 2024
          </span>
          <p>
           Award winners announced at this year's PyTorch Conference
          </p>
         </a>
        </div>
       </div>
      </li>
      <li>
       <div class="resources-dropdown" data-toggle="resources-dropdown" id="resourcesDropdownButton">
        <a class="with-down-arrow">
         Edge
        </a>
        <div class="resources-dropdown-menu">
         <a class="nav-dropdown-item" href="https://pytorch.org/edge">
          <span class="dropdown-title">
           About PyTorch Edge
          </span>
          <p>
           Build innovative and privacy-aware AI experiences for edge devices
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/executorch-overview">
          <span class="dropdown-title">
           ExecuTorch
          </span>
          <p>
           End-to-end solution for enabling on-device inference capabilities across mobile and edge devices
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/executorch/stable/index.html">
          <span class="dropdown-title">
           ExecuTorch Docs
          </span>
         </a>
        </div>
       </div>
      </li>
      <li class="main-menu-item">
       <div class="resources-dropdown" data-toggle="resources-dropdown" id="resourcesDropdownButton">
        <a class="with-down-arrow">
         Docs
        </a>
        <div class="resources-dropdown-menu">
         <a class="nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
          <span class="dropdown-title">
           PyTorch
          </span>
          <p>
           Explore the documentation for comprehensive guidance on how to use PyTorch
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/pytorch-domains">
          <span class="dropdown-title">
           PyTorch Domains
          </span>
          <p>
           Read the PyTorch Domains documentation to learn more about domain-specific libraries
          </p>
         </a>
        </div>
       </div>
      </li>
      <li>
       <div class="resources-dropdown" data-toggle="resources-dropdown" id="resourcesDropdownButton">
        <a class="with-down-arrow">
         Blogs &amp; News
        </a>
        <div class="resources-dropdown-menu">
         <a class="nav-dropdown-item" href="https://pytorch.org/blog/">
          <span class="dropdown-title">
           PyTorch Blog
          </span>
          <p>
           Catch up on the latest technical news and happenings
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/community-blog">
          <span class="dropdown-title">
           Community Blog
          </span>
          <p>
           Stories from the PyTorch ecosystem
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/videos">
          <span class="dropdown-title">
           Videos
          </span>
          <p>
           Learn about the latest PyTorch tutorials, new, and more
          </p>
          <a class="nav-dropdown-item" href="https://pytorch.org/community-stories">
           <span class="dropdown-title">
            Community Stories
           </span>
           <p>
            Learn how our community solves real, everyday machine learning problems with PyTorch
           </p>
          </a>
          <a class="nav-dropdown-item" href="https://pytorch.org/events">
           <span class="dropdown-title">
            Events
           </span>
           <p>
            Find events, webinars, and podcasts
           </p>
          </a>
          <a class="nav-dropdown-item" href="https://pytorch.org/newsletter">
           <span class="dropdown-title">
            Newsletter
           </span>
           <p>
            Stay up-to-date with the latest updates
           </p>
          </a>
         </a>
        </div>
       </div>
      </li>
      <li>
       <div class="resources-dropdown" data-toggle="resources-dropdown" id="resourcesDropdownButton">
        <a class="with-down-arrow">
         About
        </a>
        <div class="resources-dropdown-menu">
         <a class="nav-dropdown-item" href="https://pytorch.org/foundation">
          <span class="dropdown-title">
           PyTorch Foundation
          </span>
          <p>
           Learn more about the PyTorch Foundation
          </p>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/governing-board">
          <span class="dropdown-title">
           Governing Board
          </span>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/credits">
          <span class="dropdown-title">
           Cloud Credit Program
          </span>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/tac">
          <span class="dropdown-title">
           Technical Advisory Council
          </span>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/staff">
          <span class="dropdown-title">
           Staff
          </span>
         </a>
         <a class="nav-dropdown-item" href="https://pytorch.org/contact-us">
          <span class="dropdown-title">
           Contact Us
          </span>
         </a>
        </div>
       </div>
      </li>
      <li class="main-menu-item">
       <div class="no-dropdown">
        <a data-cta="join" href="https://pytorch.org/join">
         Become a Member
        </a>
       </div>
      </li>
      <li>
       <div class="main-menu-item">
        <a class="github-icon" href="https://github.com/pytorch/pytorch">
        </a>
       </div>
      </li>
      <!--- TODO: This block adds the search icon to the nav bar. We will enable it later. 
          <li>
            <div class="main-menu-item">
             <a href="https://github.com/pytorch/pytorch" class="search-icon">
             </a>
            </div>
          </li>
          --->
     </ul>
    </div>
    <a class="main-menu-open-button" data-behavior="open-mobile-menu" href="#">
    </a>
   </div>
  </div>
 </div>
 <body class="pytorch-body">
  <div class="table-of-contents-link-wrapper">
   <span>
    Table of Contents
   </span>
   <a class="toggle-table-of-contents" data-behavior="toggle-table-of-contents" href="#">
   </a>
  </div>
  <nav class="pytorch-left-menu" data-toggle="wy-nav-shift" id="pytorch-left-menu">
   <div class="pytorch-side-scroll">
    <div aria-label="main navigation" class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation">
     <div class="pytorch-left-menu-search">
      <div class="version">
       <a href="https://pytorch.org/docs/versions.html">
        2.7 ▼
       </a>
      </div>
      <div id="searchBox">
       <div class="searchbox" id="googleSearchBox">
        <script async="" src="https://cse.google.com/cse.js?cx=e65585f8c3ea1440e">
        </script>
        <div class="gcse-search">
        </div>
       </div>
       <div id="sphinxSearchBox" style="display: none;">
        <div role="search">
         <form action="../../search.html" class="wy-form" id="rtd-search-form" method="get">
          <input name="q" placeholder="Search Docs" type="text"/>
          <input name="check_keywords" type="hidden" value="yes"/>
          <input name="area" type="hidden" value="default"/>
         </form>
        </div>
       </div>
      </div>
      <form id="searchForm">
       <label style="margin-bottom: 1rem">
        <input checked="" name="searchType" type="radio" value="google"/>
        Google Search
       </label>
       <label style="margin-bottom: 1rem">
        <input name="searchType" type="radio" value="sphinx"/>
        Classic Search
       </label>
      </form>
      <script>
       document.addEventListener('DOMContentLoaded', function() {
      const searchForm = document.getElementById('searchForm');
      const googleSearchBox = document.getElementById('googleSearchBox');
      const sphinxSearchBox = document.getElementById('sphinxSearchBox');
      // Function to toggle search box visibility
      function toggleSearchBox(searchType) {
        googleSearchBox.style.display = searchType === 'google' ? 'block' : 'none';
        sphinxSearchBox.style.display = searchType === 'sphinx' ? 'block' : 'none';
      }
      // Determine the default search type
      let defaultSearchType;
      const currentUrl = window.location.href;
      if (currentUrl.startsWith('https://pytorch.org/docs/stable')) {
        // For the stable documentation, default to Google
        defaultSearchType = localStorage.getItem('searchType') || 'google';
      } else {
        // For any other version, including docs-preview, default to Sphinx
        defaultSearchType = 'sphinx';
      }
      // Set the default search type
      document.querySelector(`input[name="searchType"][value="${defaultSearchType}"]`).checked = true;
      toggleSearchBox(defaultSearchType);
      // Event listener for changes in search type
      searchForm.addEventListener('change', function(event) {
        const selectedSearchType = event.target.value;
        localStorage.setItem('searchType', selectedSearchType);
        toggleSearchBox(selectedSearchType);
      });
      // Set placeholder text for Google search box
      window.onload = function() {
        var placeholderText = "Search Docs";
        var googleSearchboxText = document.querySelector("#gsc-i-id1");
        if (googleSearchboxText) {
          googleSearchboxText.placeholder = placeholderText;
          googleSearchboxText.style.fontFamily = 'FreightSans';
          googleSearchboxText.style.fontSize = "1.2rem";
          googleSearchboxText.style.color = '#262626';
        }
      };
    });
      </script>
     </div>
     <p class="caption" role="heading">
      <span class="caption-text">
       Community
      </span>
     </p>
     <ul>
      <li class="toctree-l1">
       <a class="reference internal" href="../../community/build_ci_governance.html">
        PyTorch Governance | Build + CI
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../community/contribution_guide.html">
        PyTorch Contribution Guide
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../community/design.html">
        PyTorch Design Philosophy
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../community/governance.html">
        PyTorch Governance | Mechanics
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../community/persons_of_interest.html">
        PyTorch Governance | Maintainers
       </a>
      </li>
     </ul>
     <p class="caption" role="heading">
      <span class="caption-text">
       Developer Notes
      </span>
     </p>
     <ul>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/amp_examples.html">
        Automatic Mixed Precision examples
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/autograd.html">
        Autograd mechanics
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/broadcasting.html">
        Broadcasting semantics
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/cpu_threading_torchscript_inference.html">
        CPU threading and TorchScript inference
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/cuda.html">
        CUDA semantics
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/custom_operators.html">
        PyTorch Custom Operators Landing Page
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/ddp.html">
        Distributed Data Parallel
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/extending.html">
        Extending PyTorch
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/extending.func.html">
        Extending torch.func with autograd.Function
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/faq.html">
        Frequently Asked Questions
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/fsdp.html">
        FSDP Notes
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/get_start_xpu.html">
        Getting Started on Intel GPU
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/gradcheck.html">
        Gradcheck mechanics
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/hip.html">
        HIP (ROCm) semantics
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/large_scale_deployments.html">
        Features for large-scale deployments
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/libtorch_stable_abi.html">
        LibTorch Stable ABI
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/modules.html">
        Modules
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/mps.html">
        MPS backend
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/multiprocessing.html">
        Multiprocessing best practices
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/numerical_accuracy.html">
        Numerical accuracy
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/randomness.html">
        Reproducibility
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/serialization.html">
        Serialization semantics
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../notes/windows.html">
        Windows FAQ
       </a>
      </li>
     </ul>
     <p class="caption" role="heading">
      <span class="caption-text">
       Language Bindings
      </span>
     </p>
     <ul>
      <li class="toctree-l1">
       <a class="reference internal" href="../../cpp_index.html">
        C++
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference external" href="https://pytorch.org/javadoc/">
        Javadoc
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../deploy.html">
        torch::deploy
       </a>
      </li>
     </ul>
     <p class="caption" role="heading">
      <span class="caption-text">
       Python API
      </span>
     </p>
     <ul>
      <li class="toctree-l1">
       <a class="reference internal" href="../../torch.html">
        torch
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../nn.html">
        torch.nn
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../nn.functional.html">
        torch.nn.functional
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../tensors.html">
        torch.Tensor
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../tensor_attributes.html">
        Tensor Attributes
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../tensor_view.html">
        Tensor Views
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../amp.html">
        torch.amp
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../autograd.html">
        torch.autograd
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../library.html">
        torch.library
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../accelerator.html">
        torch.accelerator
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../cpu.html">
        torch.cpu
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../cuda.html">
        torch.cuda
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../torch_cuda_memory.html">
        Understanding CUDA Memory Usage
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../torch_cuda_memory.html#generating-a-snapshot">
        Generating a Snapshot
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../torch_cuda_memory.html#using-the-visualizer">
        Using the visualizer
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../torch_cuda_memory.html#snapshot-api-reference">
        Snapshot API Reference
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../mps.html">
        torch.mps
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../xpu.html">
        torch.xpu
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../mtia.html">
        torch.mtia
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../mtia.memory.html">
        torch.mtia.memory
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../meta.html">
        Meta device
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../backends.html">
        torch.backends
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../export.html">
        torch.export
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../distributed.html">
        torch.distributed
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../distributed.tensor.html">
        torch.distributed.tensor
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../distributed.algorithms.join.html">
        torch.distributed.algorithms.join
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../distributed.elastic.html">
        torch.distributed.elastic
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../fsdp.html">
        torch.distributed.fsdp
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../distributed.fsdp.fully_shard.html">
        torch.distributed.fsdp.fully_shard
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../distributed.tensor.parallel.html">
        torch.distributed.tensor.parallel
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../distributed.optim.html">
        torch.distributed.optim
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../distributed.pipelining.html">
        torch.distributed.pipelining
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../distributed.checkpoint.html">
        torch.distributed.checkpoint
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../distributions.html">
        torch.distributions
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../torch.compiler.html">
        torch.compiler
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../fft.html">
        torch.fft
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../func.html">
        torch.func
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../futures.html">
        torch.futures
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../fx.html">
        torch.fx
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../fx.experimental.html">
        torch.fx.experimental
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../hub.html">
        torch.hub
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../jit.html">
        torch.jit
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../linalg.html">
        torch.linalg
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../monitor.html">
        torch.monitor
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../signal.html">
        torch.signal
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../special.html">
        torch.special
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../torch.overrides.html">
        torch.overrides
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../package.html">
        torch.package
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../profiler.html">
        torch.profiler
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../nn.init.html">
        torch.nn.init
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../nn.attention.html">
        torch.nn.attention
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../onnx.html">
        torch.onnx
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../optim.html">
        torch.optim
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../complex_numbers.html">
        Complex Numbers
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../ddp_comm_hooks.html">
        DDP Communication Hooks
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../quantization.html">
        Quantization
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../rpc.html">
        Distributed RPC Framework
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../random.html">
        torch.random
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../masked.html">
        torch.masked
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../nested.html">
        torch.nested
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../size.html">
        torch.Size
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../sparse.html">
        torch.sparse
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../storage.html">
        torch.Storage
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../testing.html">
        torch.testing
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../utils.html">
        torch.utils
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../benchmark_utils.html">
        torch.utils.benchmark
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../bottleneck.html">
        torch.utils.bottleneck
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../checkpoint.html">
        torch.utils.checkpoint
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../cpp_extension.html">
        torch.utils.cpp_extension
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../data.html">
        torch.utils.data
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../deterministic.html">
        torch.utils.deterministic
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../jit_utils.html">
        torch.utils.jit
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../dlpack.html">
        torch.utils.dlpack
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../mobile_optimizer.html">
        torch.utils.mobile_optimizer
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../model_zoo.html">
        torch.utils.model_zoo
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../tensorboard.html">
        torch.utils.tensorboard
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../module_tracker.html">
        torch.utils.module_tracker
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../type_info.html">
        Type Info
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../named_tensor.html">
        Named Tensors
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../name_inference.html">
        Named Tensors operator coverage
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../config_mod.html">
        torch.__config__
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../future_mod.html">
        torch.__future__
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../logging.html">
        torch._logging
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="../../torch_environment_variables.html">
        Torch Environment Variables
       </a>
      </li>
     </ul>
     <p class="caption" role="heading">
      <span class="caption-text">
       Libraries
      </span>
     </p>
     <ul>
      <li class="toctree-l1">
       <a class="reference external" href="https://pytorch.org/audio/stable">
        torchaudio
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference external" href="https://pytorch.org/data">
        TorchData
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference external" href="https://pytorch.org/torchrec">
        TorchRec
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference external" href="https://pytorch.org/serve">
        TorchServe
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference external" href="https://pytorch.org/text/stable">
        torchtext
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference external" href="https://pytorch.org/vision/stable">
        torchvision
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference external" href="https://pytorch.org/xla/">
        PyTorch on XLA Devices
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference external" href="https://pytorch.org/ao">
        torchao
       </a>
      </li>
     </ul>
    </div>
   </div>
  </nav>
  <div class="pytorch-container">
   <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
    <div class="pytorch-breadcrumbs-wrapper">
     <div aria-label="breadcrumbs navigation" role="navigation">
      <ul class="pytorch-breadcrumbs">
       <li>
        <a href="../../index.html">
         Docs
        </a>
        &gt;
       </li>
       <li>
        <a href="../index.html">
         Module code
        </a>
        &gt;
       </li>
       <li>
        <a href="../torch.html">
         torch
        </a>
        &gt;
       </li>
       <li>
        torch.compiler
       </li>
       <li class="pytorch-breadcrumbs-aside">
       </li>
      </ul>
     </div>
    </div>
    <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
     Shortcuts
    </div>
   </div>
   <section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
    <div class="pytorch-content-left">
     <!-- Google Tag Manager (noscript) -->
     <noscript>
      <iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-T8XT4PS" style="display:none;visibility:hidden" width="0">
      </iframe>
     </noscript>
     <!-- End Google Tag Manager (noscript) -->
     <div class="rst-content">
      <div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
       <article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
        <h1>
         Source code for torch.compiler
        </h1>
        <div class="highlight">
         <pre>
<span></span><span class="c1"># mypy: allow-untyped-defs</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">TypeVar</span>
<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">ParamSpec</span>

<span class="kn">import</span> <span class="nn">torch</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">config</span>


<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">._cache</span> <span class="kn">import</span> <span class="n">CacheInfo</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"compile"</span><span class="p">,</span>
    <span class="s2">"config"</span><span class="p">,</span>
    <span class="s2">"assume_constant_result"</span><span class="p">,</span>
    <span class="s2">"reset"</span><span class="p">,</span>
    <span class="s2">"allow_in_graph"</span><span class="p">,</span>
    <span class="s2">"substitute_in_graph"</span><span class="p">,</span>
    <span class="s2">"list_backends"</span><span class="p">,</span>
    <span class="s2">"disable"</span><span class="p">,</span>
    <span class="s2">"set_stance"</span><span class="p">,</span>
    <span class="s2">"cudagraph_mark_step_begin"</span><span class="p">,</span>
    <span class="s2">"wrap_numpy"</span><span class="p">,</span>
    <span class="s2">"is_compiling"</span><span class="p">,</span>
    <span class="s2">"is_dynamo_compiling"</span><span class="p">,</span>
    <span class="s2">"is_exporting"</span><span class="p">,</span>
    <span class="s2">"save_cache_artifacts"</span><span class="p">,</span>
    <span class="s2">"load_cache_artifacts"</span><span class="p">,</span>
<span class="p">]</span>


<span class="n">_P</span> <span class="o">=</span> <span class="n">ParamSpec</span><span class="p">(</span><span class="s2">"_P"</span><span class="p">)</span>
<span class="n">_R</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">"_R"</span><span class="p">)</span>


<div class="viewcode-block" id="compile"><a class="viewcode-back" href="../../generated/torch.compiler.compile.html#torch.compiler.compile">[docs]</a><span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    See :func:`torch.compile` for details on the arguments for this function.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="reset"><a class="viewcode-back" href="../../generated/torch.compiler.reset.html#torch.compiler.reset">[docs]</a><span class="k">def</span> <span class="nf">reset</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    This function clears all compilation caches and restores the system to its initial state.</span>
<span class="sd">    It is recommended to call this function, especially after using operations like `torch.compile(...)`</span>
<span class="sd">    to ensure a clean state before another unrelated compilation</span>
<span class="sd">    """</span>
    <span class="kn">import</span> <span class="nn">torch._dynamo</span>

    <span class="n">torch</span><span class="o">.</span><span class="n">_dynamo</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></div>


<div class="viewcode-block" id="allow_in_graph"><a class="viewcode-back" href="../../generated/torch.compiler.allow_in_graph.html#torch.compiler.allow_in_graph">[docs]</a><span class="k">def</span> <span class="nf">allow_in_graph</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Tells the compiler frontend (Dynamo) to skip symbolic introspection of the function</span>
<span class="sd">    and instead directly write it to the graph when encountered.</span>

<span class="sd">    If you are using :func:`torch.compile` (with backend="inductor" (the default)), or</span>
<span class="sd">    :func:`torch.export.export`, and trying to black-box a Python function throughout</span>
<span class="sd">    all tracing, do not use this API.</span>
<span class="sd">    Instead, please create a custom operator (see `PyTorch Custom Operators Landing Page</span>
<span class="sd">    &lt;https://pytorch.org/tutorials/advanced/custom_ops_landing_page.html&gt;`_)</span>

<span class="sd">    .. warning::</span>

<span class="sd">        If you're a typical torch.compile user (e.g. you're applying torch.compile to</span>
<span class="sd">        a model to make it run faster), you probably don't want to use this function.</span>
<span class="sd">        :func:`allow_in_graph` is a footgun because it skips the compiler frontend</span>
<span class="sd">        (Dynamo) that is responsible for doing safety checks (graph breaks, handling</span>
<span class="sd">        closures, etc). Incorrect usage will lead to difficult-to-debug silent</span>
<span class="sd">        incorrectness issues.</span>

<span class="sd">    Given a Python function with no allow_in_graph decorator, regular execution</span>
<span class="sd">    of torch.compile traces through the function. :func:`allow_in_graph` changes</span>
<span class="sd">    it so that the frontend does not trace inside the function, but the compiler</span>
<span class="sd">    backend still traces through it. Compare this to custom operators, which</span>
<span class="sd">    treats a function as a black box throughout the torch.compile stack. The following</span>
<span class="sd">    table compares these mechanisms.</span>

<span class="sd">    +------------------------+-----------------------+--------------------------------+</span>
<span class="sd">    | Mechanism              | Frontend (Dynamo)     | Backend (AOTAutograd+Inductor) |</span>
<span class="sd">    +========================+=======================+================================+</span>
<span class="sd">    | no decorator           | trace inside          | trace inside                   |</span>
<span class="sd">    +------------------------+-----------------------+--------------------------------+</span>
<span class="sd">    | allow_in_graph         | opaque callable       | trace inside                   |</span>
<span class="sd">    +------------------------+-----------------------+--------------------------------+</span>
<span class="sd">    | custom op              | opaque callable       | opaque callable                |</span>
<span class="sd">    +------------------------+-----------------------+--------------------------------+</span>

<span class="sd">    One common use case for :func:`allow_in_graph()` is as an escape hatch for the compiler</span>
<span class="sd">    frontend: if you know the function works w.r.t. to the downstream components of the</span>
<span class="sd">    compilation stack (AOTAutograd and Inductor) but there is a Dynamo bug that prevents it from</span>
<span class="sd">    symbolically introspecting the function properly (or if your code is in C/C++ and</span>
<span class="sd">    therefore cannot be introspected with Dynamo), then one can decorate said function</span>
<span class="sd">    with :func:`allow_in_graph` to bypass Dynamo.</span>

<span class="sd">    We require that ``fn`` adhere to the following restrictions. Failure to adhere</span>
<span class="sd">    results in undefined behavior:</span>

<span class="sd">    - The inputs to ``fn`` must be Proxy-able types in the FX graph. Valid types include:</span>
<span class="sd">      Tensor/int/bool/float/None/List[Tensor?]/List[int?]/List[float?]</span>
<span class="sd">      Tuple[Tensor?, ...]/Tuple[int?, ...]/Tuple[float?, ...]/torch.dtype/torch.device</span>
<span class="sd">    - The outputs to ``fn`` must be Proxy-able types in the FX graph (see previous bullet)</span>
<span class="sd">    - all Tensors used inside of ``fn`` must be passed directly as inputs to ``fn``</span>
<span class="sd">      (as opposed to being captured variables).</span>

<span class="sd">    Args:</span>
<span class="sd">        fn: A callable representing the function to be included in the graph.</span>
<span class="sd">            If ``fn`` is a list or tuple of callables it recursively applies</span>
<span class="sd">            :func:`allow_in_graph()` to each function and returns a new list or</span>
<span class="sd">            tuple containing the modified functions.</span>

<span class="sd">    Example::</span>

<span class="sd">        torch.compiler.allow_in_graph(my_custom_function)</span>

<span class="sd">        @torch.compile(...)</span>
<span class="sd">        def fn(x):</span>
<span class="sd">            x = torch.add(x, 1)</span>
<span class="sd">            x = my_custom_function(x)</span>
<span class="sd">            x = torch.add(x, 1)</span>
<span class="sd">            return x</span>

<span class="sd">        fn(...)</span>

<span class="sd">    Will capture a single graph containing ``my_custom_function()``.</span>

<span class="sd">    """</span>
    <span class="kn">import</span> <span class="nn">torch._dynamo</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">_dynamo</span><span class="o">.</span><span class="n">allow_in_graph</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span></div>


<div class="viewcode-block" id="substitute_in_graph"><a class="viewcode-back" href="../../generated/torch.compiler.substitute_in_graph.html#torch.compiler.substitute_in_graph">[docs]</a><span class="k">def</span> <span class="nf">substitute_in_graph</span><span class="p">(</span>
    <span class="n">original_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_R</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">can_constant_fold_through</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_signature_check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_R</span><span class="p">]],</span> <span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_R</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Register a polyfill handler for a function, usually a C function from the C extension, to be</span>
<span class="sd">    used in place of the original function when inlining the original function in the graph.</span>

<span class="sd">    .. note::</span>

<span class="sd">        The polyfill handler is only used when inlining the original function. It is not used when</span>
<span class="sd">        the original function is called directly. In the eager mode, the decorated function calls</span>
<span class="sd">        the performant C function rather than the polyfill handler.</span>

<span class="sd">    The polyfill handler is a function that will be called in place of the original function when</span>
<span class="sd">    inlining the original function. The polyfill handler should have the same signature and the same</span>
<span class="sd">    behavior as the original function.</span>

<span class="sd">    Args:</span>
<span class="sd">        original_fn (callable): The original function, usually a C function, to register a polyfill</span>
<span class="sd">            handler for.</span>
<span class="sd">        can_constant_fold_through (bool, optional): Whether the polyfill handler can be constant</span>
<span class="sd">            folded through. That is, if the polyfill handler is a pure function and its arguments</span>
<span class="sd">            are constant, the result of the polyfill handler can be constant folded during the</span>
<span class="sd">            compilation. Defaults to ``False``.</span>
<span class="sd">        skip_signature_check (bool, optional): Whether to skip the signature check between the</span>
<span class="sd">            original function and the polyfill handler. Defaults to ``False``.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A decorator that registers the polyfill handler for the original function.</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; import operator</span>
<span class="sd">        &gt;&gt;&gt; operator.indexOf([1, 2, 3, 4, 5], 3)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; torch.compile(operator.indexOf, fullgraph=True)([1, 2, 3, 4, 5], 3)</span>
<span class="sd">        ... # xdoctest: +SKIP("Long tracebacks")</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        torch._dynamo.exc.Unsupported: ...</span>

<span class="sd">        &gt;&gt;&gt; @torch.compiler.substitute_in_graph(operator.indexOf)</span>
<span class="sd">        ... def indexOf(a, b, /):</span>
<span class="sd">        ...     for i, item in enumerate(a):</span>
<span class="sd">        ...         if item is b or item == b:</span>
<span class="sd">        ...             return i</span>
<span class="sd">        ...     raise ValueError("sequence.index(x): x not in sequence")</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; torch.compile(operator.indexOf, fullgraph=True)([1, 2, 3, 4, 5], 3)</span>
<span class="sd">        2</span>
<span class="sd">    """</span>
    <span class="kn">import</span> <span class="nn">torch._dynamo</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">_dynamo</span><span class="o">.</span><span class="n">substitute_in_graph</span><span class="p">(</span>
        <span class="n">original_fn</span><span class="p">,</span>
        <span class="n">can_constant_fold_through</span><span class="o">=</span><span class="n">can_constant_fold_through</span><span class="p">,</span>
        <span class="n">skip_signature_check</span><span class="o">=</span><span class="n">skip_signature_check</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="list_backends"><a class="viewcode-back" href="../../generated/torch.compiler.list_backends.html#torch.compiler.list_backends">[docs]</a><span class="k">def</span> <span class="nf">list_backends</span><span class="p">(</span><span class="n">exclude_tags</span><span class="o">=</span><span class="p">(</span><span class="s2">"debug"</span><span class="p">,</span> <span class="s2">"experimental"</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Return valid strings that can be passed to `torch.compile(..., backend="name")`.</span>

<span class="sd">    Args:</span>
<span class="sd">        exclude_tags(optional): A tuple of strings representing tags to exclude.</span>
<span class="sd">    """</span>
    <span class="kn">import</span> <span class="nn">torch._dynamo</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">_dynamo</span><span class="o">.</span><span class="n">list_backends</span><span class="p">(</span><span class="n">exclude_tags</span><span class="p">)</span></div>


<div class="viewcode-block" id="assume_constant_result"><a class="viewcode-back" href="../../generated/torch.compiler.assume_constant_result.html#torch.compiler.assume_constant_result">[docs]</a><span class="k">def</span> <span class="nf">assume_constant_result</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    This function is used to mark a function `fn` as having a constant result.</span>
<span class="sd">    This allows the compiler to optimize away your function.</span>
<span class="sd">    Returns The same function `fn`</span>

<span class="sd">    Args:</span>
<span class="sd">        fn: The function to be marked as having a constant result.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        `assume_constant_result` can if invalid cause safety and soundness issues, :func:`torch.compile`</span>
<span class="sd">        will not attempt to validate whether the constant assumption is true or not</span>

<span class="sd">    """</span>
    <span class="kn">import</span> <span class="nn">torch._dynamo</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">_dynamo</span><span class="o">.</span><span class="n">assume_constant_result</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span></div>


<div class="viewcode-block" id="disable"><a class="viewcode-back" href="../../generated/torch.compiler.disable.html#torch.compiler.disable">[docs]</a><span class="k">def</span> <span class="nf">disable</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    This function provides a decorator to disable compilation on a function.</span>
<span class="sd">    It also provides the option of recursively disabling called functions.</span>

<span class="sd">    Args:</span>
<span class="sd">        fn (optional): The function to disable</span>
<span class="sd">        recursive (optional): A boolean value indicating whether the disabling should be recursive.</span>
<span class="sd">    """</span>
    <span class="kn">import</span> <span class="nn">torch._dynamo</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">_dynamo</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">recursive</span><span class="p">)</span></div>


<div class="viewcode-block" id="set_stance"><a class="viewcode-back" href="../../generated/torch.compiler.set_stance.html#torch.compiler.set_stance">[docs]</a><span class="k">def</span> <span class="nf">set_stance</span><span class="p">(</span>
    <span class="n">stance</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"default"</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">skip_guard_eval_unsafe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">force_backend</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Set the current stance of the compiler.</span>
<span class="sd">    Can be used as a function, context manager, or decorator.</span>
<span class="sd">    Do not use this function inside a `torch.compile` region - an error will be raised otherwise.</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        @torch.compile</span>
<span class="sd">        def foo(x):</span>
<span class="sd">            ...</span>

<span class="sd">        @torch.compiler.set_stance("force_eager")</span>
<span class="sd">        def bar():</span>
<span class="sd">            # will not be compiled</span>
<span class="sd">            foo(...)</span>

<span class="sd">        bar()</span>

<span class="sd">        with torch.compiler.set_stance("force_eager"):</span>
<span class="sd">            # will also not be compiled</span>
<span class="sd">            foo(...)</span>

<span class="sd">        torch.compiler.set_stance("force_eager")</span>
<span class="sd">        # will also not be compiled</span>
<span class="sd">        foo(...)</span>
<span class="sd">        torch.compiler.set_stance("default")</span>

<span class="sd">        # will be compiled</span>
<span class="sd">        foo(...)</span>

<span class="sd">    Args:</span>
<span class="sd">        stance: The stance to set the compiler to. Valid values are:</span>

<span class="sd">            - "default": The default stance, used for normal compilation.</span>
<span class="sd">            - "force_eager": Ignore all `torch.compile` directives.</span>
<span class="sd">            - "eager_on_recompile": Run code eagerly when a recompile is necessary.</span>
<span class="sd">              If there is cached compiled code valid for the input, it will still be used.</span>
<span class="sd">            - "fail_on_recompile": Raise an error when recompiling a function.</span>

<span class="sd">        skip_guard_eval_unsafe: A flag to run only differentiating guards.</span>
<span class="sd">            CAUTION - This flag is unsafe and should only be used if your setup</span>
<span class="sd">            meets the following conditions.</span>

<span class="sd">            torch.compile uses a guard system to support recompilations and</span>
<span class="sd">            choose which compiled artifact to run at runtime.  These guards,</span>
<span class="sd">            though efficient, add some overhead, which may impact performance in</span>
<span class="sd">            scenarios where you need to optimize for minimal guard processing</span>
<span class="sd">            time.  This API enables you to disable guard evaluation, assuming</span>
<span class="sd">            that you have warmed up the compiled model with a sufficient variety</span>
<span class="sd">            of inputs. This assumption means that, after the warmup phase, no</span>
<span class="sd">            further recompilations will be necessary.  If this assumption fails,</span>
<span class="sd">            there is a risk of silently producing incorrect results (hence the</span>
<span class="sd">            term "unsafe" in the API name).</span>

<span class="sd">        force_backend: If `stance` is "default", this argument can be used to force `torch.compile`</span>
<span class="sd">            to use a specific backend. Otherwise, an error is raised.</span>
<span class="sd">    """</span>
    <span class="kn">import</span> <span class="nn">torch._dynamo</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">_dynamo</span><span class="o">.</span><span class="n">set_stance</span><span class="p">(</span>
        <span class="n">stance</span><span class="p">,</span>
        <span class="n">skip_guard_eval_unsafe</span><span class="o">=</span><span class="n">skip_guard_eval_unsafe</span><span class="p">,</span>
        <span class="n">force_backend</span><span class="o">=</span><span class="n">force_backend</span><span class="p">,</span>
    <span class="p">)</span></div>


<span class="c1"># forbid in graph</span>
<span class="n">set_stance</span><span class="o">.</span><span class="n">_dynamo_forbidden</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># type: ignore[attr-defined]</span>


<div class="viewcode-block" id="cudagraph_mark_step_begin"><a class="viewcode-back" href="../../generated/torch.compiler.cudagraph_mark_step_begin.html#torch.compiler.cudagraph_mark_step_begin">[docs]</a><span class="k">def</span> <span class="nf">cudagraph_mark_step_begin</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Indicates that a new iteration of inference or training is about to begin.</span>

<span class="sd">    CUDA Graphs will free tensors of a prior iteration. A new iteration is started on each invocation of</span>
<span class="sd">    torch.compile, so long as there is not a pending backward that has not been called.</span>

<span class="sd">    If that heuristic is wrong, such as in the following example, manually mark it with this api.</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        @torch.compile(mode="reduce-overhead")</span>
<span class="sd">        def rand_foo():</span>
<span class="sd">            return torch.rand([4], device="cuda")</span>

<span class="sd">        for _ in range(5):</span>
<span class="sd">            torch.compiler.cudagraph_mark_step_begin()</span>
<span class="sd">            rand_foo() + rand_foo()</span>

<span class="sd">    For more details, see `torch.compiler_cudagraph_trees &lt;https://pytorch.org/docs/main/torch.compiler_cudagraph_trees.html&gt;`__</span>
<span class="sd">    """</span>
    <span class="kn">from</span> <span class="nn">torch._inductor</span> <span class="kn">import</span> <span class="n">cudagraph_trees</span>

    <span class="n">cudagraph_trees</span><span class="o">.</span><span class="n">mark_step_begin</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">wrap_numpy</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">"""Decorator that turns a function from ``np.ndarray``s to ``np.ndarray``s into a function</span>
<span class="sd">    from ``torch.Tensor``s to ``torch.Tensor``s.</span>

<span class="sd">    It is designed to be used with :func:`torch.compile` with ``fullgraph=True``. It allows to</span>
<span class="sd">    compile a NumPy function as if it were a PyTorch function. This allows you to run NumPy code</span>
<span class="sd">    on CUDA or compute its gradients.</span>

<span class="sd">    .. note::</span>

<span class="sd">        This decorator does not work without :func:`torch.compile`.</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(env:TORCH_DOCTEST_CUDA)</span>
<span class="sd">        &gt;&gt;&gt; # Compile a NumPy function as a Tensor -&gt; Tensor function</span>
<span class="sd">        &gt;&gt;&gt; @torch.compile(fullgraph=True)</span>
<span class="sd">        &gt;&gt;&gt; @torch.compiler.wrap_numpy</span>
<span class="sd">        &gt;&gt;&gt; def fn(a: np.ndarray):</span>
<span class="sd">        &gt;&gt;&gt;     return np.sum(a * a)</span>
<span class="sd">        &gt;&gt;&gt; # Execute the NumPy function using Tensors on CUDA and compute the gradients</span>
<span class="sd">        &gt;&gt;&gt; x = torch.arange(6, dtype=torch.float32, device="cuda", requires_grad=True)</span>
<span class="sd">        &gt;&gt;&gt; out = fn(x)</span>
<span class="sd">        &gt;&gt;&gt; out.backward()</span>
<span class="sd">        &gt;&gt;&gt; print(x.grad)</span>
<span class="sd">        tensor([ 0.,  2.,  4.,  6.,  8., 10.], device='cuda:0')</span>
<span class="sd">    """</span>
    <span class="kn">from</span> <span class="nn">torch._dynamo.external_utils</span> <span class="kn">import</span> <span class="n">wrap_numpy</span> <span class="k">as</span> <span class="n">wrap</span>

    <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>


<span class="n">_is_compiling_flag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">_is_exporting_flag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>


<div class="viewcode-block" id="is_compiling"><a class="viewcode-back" href="../../generated/torch.compiler.is_compiling.html#torch.compiler.is_compiling">[docs]</a><span class="k">def</span> <span class="nf">is_compiling</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Indicates whether a graph is executed/traced as part of torch.compile() or torch.export().</span>

<span class="sd">    Note that there are 2 other related flags that should deprecated eventually:</span>
<span class="sd">      * torch._dynamo.external_utils.is_compiling()</span>
<span class="sd">      * torch._utils.is_compiling()</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; def forward(self, x):</span>
<span class="sd">        &gt;&gt;&gt;     if not torch.compiler.is_compiling():</span>
<span class="sd">        &gt;&gt;&gt;        pass # ...logic that is not needed in a compiled/traced graph...</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt;     # ...rest of the function...</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">is_scripting</span><span class="p">():</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_is_compiling_flag</span></div>


<div class="viewcode-block" id="is_dynamo_compiling"><a class="viewcode-back" href="../../generated/torch.compiler.is_dynamo_compiling.html#torch.compiler.is_dynamo_compiling">[docs]</a><span class="k">def</span> <span class="nf">is_dynamo_compiling</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Indicates whether a graph is traced via TorchDynamo.</span>

<span class="sd">    It's stricter than is_compiling() flag, as it would only be set to True when</span>
<span class="sd">    TorchDynamo is used.</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; def forward(self, x):</span>
<span class="sd">        &gt;&gt;&gt;     if not torch.compiler.is_dynamo_compiling():</span>
<span class="sd">        &gt;&gt;&gt;        pass # ...logic that is not needed in a TorchDynamo-traced graph...</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt;     # ...rest of the function...</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="is_exporting"><a class="viewcode-back" href="../../generated/torch.compiler.is_exporting.html#torch.compiler.is_exporting">[docs]</a><span class="k">def</span> <span class="nf">is_exporting</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Indicated whether we're under exporting.</span>

<span class="sd">    It's stricter than is_compiling() flag, as it would only be set to True when</span>
<span class="sd">    torch.export is used.</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; def forward(self, x):</span>
<span class="sd">        &gt;&gt;&gt;     if not torch.compiler.is_exporting():</span>
<span class="sd">        &gt;&gt;&gt;        pass # ...logic that is not needed in export...</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt;     # ...rest of the function...</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">_is_exporting_flag</span></div>


<span class="k">def</span> <span class="nf">save_cache_artifacts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="s2">"CacheInfo"</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Serializes all the cache artifacts that were created during the compilation</span>

<span class="sd">    Example:</span>

<span class="sd">    - Execute torch.compile</span>
<span class="sd">    - Call torch.compiler.save_cache_artifacts()</span>
<span class="sd">    """</span>
    <span class="kn">from</span> <span class="nn">._cache</span> <span class="kn">import</span> <span class="n">CacheArtifactManager</span><span class="p">,</span> <span class="n">CacheInfo</span>

    <span class="k">return</span> <span class="n">CacheArtifactManager</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">load_cache_artifacts</span><span class="p">(</span><span class="n">serialized_artifacts</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">"CacheInfo"</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Hot loads cache artifacts that were previously serialized via</span>
<span class="sd">    save_cache_artifacts</span>

<span class="sd">    Example:</span>

<span class="sd">    # From a previous invocation</span>
<span class="sd">    artifacts = torch.compiler.save_cache_artifacts()</span>

<span class="sd">    torch.compiler.load_cache_artifacts(artifacts[0])</span>
<span class="sd">    """</span>
    <span class="kn">from</span> <span class="nn">._cache</span> <span class="kn">import</span> <span class="n">CacheArtifactManager</span><span class="p">,</span> <span class="n">CacheInfo</span>

    <span class="k">return</span> <span class="n">CacheArtifactManager</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">serialized_artifacts</span><span class="p">)</span>
</pre>
        </div>
       </article>
      </div>
      <footer>
       <hr/>
       <div role="contentinfo">
        <p>
         © Copyright PyTorch Contributors.
        </p>
       </div>
       <div>
        Built with
        <a href="http://sphinx-doc.org/">
         Sphinx
        </a>
        using a
        <a href="https://github.com/rtfd/sphinx_rtd_theme">
         theme
        </a>
        provided by
        <a href="https://readthedocs.org">
         Read the Docs
        </a>
        .
       </div>
      </footer>
     </div>
     <script>
      var match = window.location.href.match(/\/_[a-zA-Z0-9_]*.html|_dynamo/gi);
var url = window.location.href.lastIndexOf(match[match.length-1]);

if (url)
  {
    var div = '<div class="admonition note"><p class="admonition-title">Note</p><p><i class="fa fa-exclamation-circle" aria-hidden="true">&nbsp</i> This page describes an internal API which is not intended to be used outside of the PyTorch codebase and can be modified or removed without notice.</p></div>'
    document.getElementById("pytorch-article").insertAdjacentHTML('afterBegin', div)
  }
     </script>
    </div>
    <div class="pytorch-content-right" id="pytorch-content-right">
     <div class="pytorch-right-menu" id="pytorch-right-menu">
      <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
      </div>
     </div>
    </div>
   </section>
  </div>
  <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js" type="text/javascript">
  </script>
  <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js">
  </script>
  <script src="../../_static/jquery.js">
  </script>
  <script src="../../_static/underscore.js">
  </script>
  <script src="../../_static/_sphinx_javascript_frameworks_compat.js">
  </script>
  <script src="../../_static/doctools.js">
  </script>
  <script src="../../_static/sphinx_highlight.js">
  </script>
  <script src="../../_static/clipboard.min.js">
  </script>
  <script src="../../_static/copybutton.js">
  </script>
  <script src="../../_static/js/vendor/popper.min.js" type="text/javascript">
  </script>
  <script src="../../_static/js/vendor/bootstrap.min.js" type="text/javascript">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js">
  </script>
  <script src="../../_static/js/theme.js" type="text/javascript">
  </script>
  <script type="text/javascript">
   jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
  <script script="" type="text/javascript">
   var collapsedSections = ['Developer Notes', 'Language Bindings', 'Libraries', 'Community'];
  </script>
  <img alt="" height="1" src="https://www.googleadservices.com/pagead/conversion/795629140/?label=txkmCPmdtosBENSssfsC&amp;guid=ON&amp;script=0" style="border-style:none;" width="1"/>
  <!-- Begin Footer -->
  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
   <div class="container">
    <div class="row">
     <div class="col-md-4 text-center">
      <h2>
       Docs
      </h2>
      <p>
       Access comprehensive developer documentation for PyTorch
      </p>
      <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">
       View Docs
      </a>
     </div>
     <div class="col-md-4 text-center">
      <h2>
       Tutorials
      </h2>
      <p>
       Get in-depth tutorials for beginners and advanced developers
      </p>
      <a class="with-right-arrow" href="https://pytorch.org/tutorials">
       View Tutorials
      </a>
     </div>
     <div class="col-md-4 text-center">
      <h2>
       Resources
      </h2>
      <p>
       Find development resources and get your questions answered
      </p>
      <a class="with-right-arrow" href="https://pytorch.org/resources">
       View Resources
      </a>
     </div>
    </div>
   </div>
  </div>
  <footer class="site-footer">
   <div class="container footer-container">
    <div class="footer-logo-wrapper">
     <a class="footer-logo" href="https://pytorch.org/">
     </a>
    </div>
    <div class="footer-links-wrapper">
     <div class="footer-links-col">
      <ul>
       <li class="list-title">
        <a href="https://pytorch.org/">
         PyTorch
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/get-started">
         Get Started
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/features">
         Features
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/ecosystem">
         Ecosystem
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/blog/">
         Blog
        </a>
       </li>
       <li>
        <a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">
         Contributing
        </a>
       </li>
      </ul>
     </div>
     <div class="footer-links-col">
      <ul>
       <li class="list-title">
        <a href="https://pytorch.org/resources">
         Resources
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/tutorials">
         Tutorials
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/docs/stable/index.html">
         Docs
        </a>
       </li>
       <li>
        <a href="https://discuss.pytorch.org" target="_blank">
         Discuss
        </a>
       </li>
       <li>
        <a href="https://github.com/pytorch/pytorch/issues" target="_blank">
         Github Issues
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">
         Brand Guidelines
        </a>
       </li>
      </ul>
     </div>
     <div class="footer-links-col">
      <ul>
       <li class="list-title">
        Stay up to date
       </li>
       <li>
        <a href="https://www.facebook.com/pytorch" target="_blank">
         Facebook
        </a>
       </li>
       <li>
        <a href="https://twitter.com/pytorch" target="_blank">
         Twitter
        </a>
       </li>
       <li>
        <a href="https://www.youtube.com/pytorch" target="_blank">
         YouTube
        </a>
       </li>
       <li>
        <a href="https://www.linkedin.com/company/pytorch" target="_blank">
         LinkedIn
        </a>
       </li>
      </ul>
     </div>
     <div class="footer-links-col">
      <ul>
       <li class="list-title">
        PyTorch Podcasts
       </li>
       <li>
        <a href="https://open.spotify.com/show/6UzHKeiy368jKfQMKKvJY5" target="_blank">
         Spotify
        </a>
       </li>
       <li>
        <a href="https://podcasts.apple.com/us/podcast/pytorch-developer-podcast/id1566080008" target="_blank">
         Apple
        </a>
       </li>
       <li>
        <a href="https://www.google.com/podcasts?feed=aHR0cHM6Ly9mZWVkcy5zaW1wbGVjYXN0LmNvbS9PQjVGa0lsOA%3D%3D" target="_blank">
         Google
        </a>
       </li>
       <li>
        <a href="https://music.amazon.com/podcasts/7a4e6f0e-26c2-49e9-a478-41bd244197d0/PyTorch-Developer-Podcast?" target="_blank">
         Amazon
        </a>
       </li>
      </ul>
     </div>
    </div>
    <div class="privacy-policy">
     <ul>
      <li class="privacy-policy-links">
       <a href="https://www.linuxfoundation.org/terms/" target="_blank">
        Terms
       </a>
      </li>
      <li class="privacy-policy-links">
       |
      </li>
      <li class="privacy-policy-links">
       <a href="https://www.linuxfoundation.org/privacy-policy/" target="_blank">
        Privacy
       </a>
      </li>
     </ul>
    </div>
    <div class="copyright">
     <p>
      © Copyright The Linux Foundation. The PyTorch Foundation is a project of The Linux Foundation.
          For web site terms of use, trademark policy and other policies applicable to The PyTorch Foundation please see
      <a href="https://www.linuxfoundation.org/policies/">
       www.linuxfoundation.org/policies/
      </a>
      . The PyTorch Foundation supports the PyTorch open source
          project, which has been established as PyTorch Project a Series of LF Projects, LLC. For policies applicable to the PyTorch Project a Series of LF Projects, LLC,
          please see
      <a href="https://www.lfprojects.org/policies/">
       www.lfprojects.org/policies/
      </a>
      .
     </p>
    </div>
   </div>
  </footer>
  <div class="cookie-banner-wrapper">
   <div class="container">
    <p class="gdpr-notice">
     To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls:
     <a href="https://www.facebook.com/policies/cookies/">
      Cookies Policy
     </a>
     .
    </p>
    <img class="close-button" src="../../_static/images/pytorch-x.svg"/>
   </div>
  </div>
  <!-- End Footer -->
  <!-- Begin Mobile Menu -->
  <div class="mobile-main-menu">
   <div class="container-fluid">
    <div class="container">
     <div class="mobile-main-menu-header-container">
      <a aria-label="PyTorch" class="header-logo" href="https://pytorch.org/">
      </a>
      <a class="main-menu-close-button" data-behavior="close-mobile-menu" href="#">
      </a>
     </div>
    </div>
   </div>
   <div class="mobile-main-menu-links-container">
    <div class="main-menu">
     <ul>
      <li class="resources-mobile-menu-title">
       <a>
        Learn
       </a>
      </li>
      <ul class="resources-mobile-menu-items">
       <li>
        <a href="https://pytorch.org/get-started">
         Get Started
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/tutorials">
         Tutorials
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/tutorials/beginner/basics/intro.html">
         Learn the Basics
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/tutorials/recipes/recipes_index.html">
         PyTorch Recipes
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/tutorials/beginner/introyt.html">
         Introduction to PyTorch - YouTube Series
        </a>
       </li>
      </ul>
      <li class="resources-mobile-menu-title">
       <a>
        Ecosystem
       </a>
      </li>
      <ul class="resources-mobile-menu-items">
       <li>
        <a href="https://pytorch.org/ecosystem">
         Tools
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/#community-module">
         Community
        </a>
       </li>
       <li>
        <a href="https://discuss.pytorch.org/">
         Forums
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/resources">
         Developer Resources
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/ecosystem/contributor-awards-2023">
         Contributor Awards - 2024
        </a>
       </li>
      </ul>
      <li class="resources-mobile-menu-title">
       <a>
        Edge
       </a>
      </li>
      <ul class="resources-mobile-menu-items">
       <li>
        <a href="https://pytorch.org/edge">
         About PyTorch Edge
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/executorch-overview">
         ExecuTorch
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/executorch/stable/index.html">
         ExecuTorch Documentation
        </a>
       </li>
      </ul>
      <li class="resources-mobile-menu-title">
       <a>
        Docs
       </a>
      </li>
      <ul class="resources-mobile-menu-items">
       <li>
        <a href="https://pytorch.org/docs/stable/index.html">
         PyTorch
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/pytorch-domains">
         PyTorch Domains
        </a>
       </li>
      </ul>
      <li class="resources-mobile-menu-title">
       <a>
        Blog &amp; News
       </a>
      </li>
      <ul class="resources-mobile-menu-items">
       <li>
        <a href="https://pytorch.org/blog/">
         PyTorch Blog
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/community-blog">
         Community Blog
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/videos">
         Videos
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/community-stories">
         Community Stories
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/events">
         Events
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/newsletter">
         Newsletter
        </a>
       </li>
      </ul>
      <li class="resources-mobile-menu-title">
       <a>
        About
       </a>
      </li>
      <ul class="resources-mobile-menu-items">
       <li>
        <a href="https://pytorch.org/foundation">
         PyTorch Foundation
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/governing-board">
         Governing Board
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/credits">
         Cloud Credit Program
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/tac">
         Technical Advisory Council
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/staff">
         Staff
        </a>
       </li>
       <li>
        <a href="https://pytorch.org/contact-us">
         Contact Us
        </a>
       </li>
      </ul>
     </ul>
    </div>
   </div>
  </div>
  <!-- End Mobile Menu -->
  <script src="../../_static/js/vendor/anchor.min.js" type="text/javascript">
  </script>
  <script type="text/javascript">
   $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
 </body>
</html>
